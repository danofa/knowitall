extends ../layout

block content
    table.table.table-hover.table-bordered.table-striped.table-condensed
        th ID
        th Title
        th Description
        th Parent
        each top in topics
            tr
                td= top._id
                td= top.title
                td= top.description
                if top.parent
                    td= top.parent.title
                else
                    td -
                td
                    a.btn.glyphicon.glyphicon-trash(href="delete/#{top._id}" title="Delete")
                    a.btn.glyphicon.glyphicon-edit(href="edit/#{top._id}" title="Edit")
    
    mixin displayChildren(topic, topics)
        - var subTopics = getChTp(topic, topics);
        if subTopics.length > 0
            | #{topic.title} 
            a.treebar.glyphicon.glyphicon-plus(href="add?pid=#{topic._id}")
            a.treebar.glyphicon.glyphicon-edit(href="edit/#{topic._id}" title="Edit")
            a.treebar.glyphicon.glyphicon-trash(href="delete/#{topic._id}" title="Delete")
            ul
                each t in subTopics
                    li
                        mixin displayChildren(t, topics)
        else
            | #{topic.title} 
            a.treebar.glyphicon.glyphicon-plus(href="add?pid=#{topic._id}") 
            a.treebar.glyphicon.glyphicon-edit(href="edit/#{topic._id}" title="Edit") 
            a.treebar.glyphicon.glyphicon-trash(href="delete/#{topic._id}" title="Delete") 
            
    ul.tree
        li 
            ul
                li 
                  a.glyphicon.glyphicon-plus(href="add")
                  each top in topics
                     if !top.parent
                        li
                           +displayChildren(top, topics)

    include ../includes/links.jade